#!/bin/sh
set -e

# --- JS/TS ---
echo "Formatting (Prettier)..."
npm run format -w @tmuxy/ui

echo "Linting (ESLint --fix)..."
npm run lint:fix -w @tmuxy/ui

# Re-stage any files auto-fixed by lint/format
git add -u packages/tmuxy-ui/src

echo "Running unit tests..."
npm test -- --run

# --- Rust ---
echo "Formatting Rust (cargo fmt)..."
cargo fmt -p tmuxy-core -p tmuxy-cli

# Re-stage any files formatted by cargo fmt
git add -u packages/tmuxy-core packages/tmuxy-cli

echo "Checking Rust (cargo clippy)..."
cargo clippy -p tmuxy-core -p tmuxy-cli
